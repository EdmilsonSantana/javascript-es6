{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["ListaNegociacoes","Mensagem","MensagemView","Negociacao","NegociacoesView","NegociacaoService","DateHelper","Bind","NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_listaNegociacoes","_mensagem","_negociacaoService","_ordemAtual","_init","listar","then","negociacoes","forEach","adiciona","negociacao","catch","texto","erro","setInterval","importaNegociacoes","event","preventDefault","_criaNegociacao","cadastrar","mensagem","_limpaFormulario","apagar","esvazia","importa","textoParaData","value","parseInt","parseFloat","focus","coluna","inverteOrdem","ordena","a","b","negociacaoController","currentInstance"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["import {ListaNegociacoes,} from '../models/ListaNegociacoes';\r\nimport {Mensagem} from '../models/Mensagem';\r\nimport {MensagemView} from '../views/MensagemView';\r\nimport {Negociacao} from '../models/Negociacao';\r\nimport {NegociacoesView} from '../views/NegociacoesView';\r\nimport {NegociacaoService} from '../services/NegociacaoService';\r\nimport {DateHelper} from '../helpers/DateHelper';\r\nimport {Bind} from '../helpers/Bind';\r\n\r\nclass NegociacaoController {\r\n\r\n\tconstructor() {\r\n\t\tlet $ = document.querySelector.bind(document);\r\n\r\n\t\tthis._inputData = $('#data');\r\n\t\tthis._inputQuantidade = $('#quantidade');\r\n\t\tthis._inputValor = $('#valor');\r\n\r\n\t\tthis._listaNegociacoes = new Bind(new ListaNegociacoes(), \r\n\t\t\tnew NegociacoesView($('#negociacoesView')),\r\n\t\t\t'adiciona', 'esvazia', 'ordena', 'inverteOrdem');\r\n\r\n\t\tthis._mensagem = new Bind(new Mensagem(), new MensagemView($('#mensagemView')), 'texto');\r\n\r\n\t\tthis._negociacaoService = new NegociacaoService();\r\n\r\n\t\tthis._ordemAtual = '';\r\n\r\n\t\tthis._init();\r\n\r\n\t}\r\n\r\n\t_init() {\r\n\r\n\t\tthis._negociacaoService\r\n\t\t\t.listar()\r\n\t\t\t.then(negociacoes => \r\n\t\t\t\tnegociacoes.forEach(negociacao =>\r\n\t\t\t\t\tthis._listaNegociacoes.adiciona(negociacao)))\r\n\t\t\t.catch(erro => this._mensagem.texto = erro);\r\n\r\n\t\tsetInterval(() => {\r\n\t\t\tthis.importaNegociacoes();\r\n\t\t}, 3000);\r\n\t}\r\n\r\n\tadiciona(event) {\r\n\r\n\t\tevent.preventDefault();\r\n\r\n\t\t\r\n\t\tlet negociacao = this._criaNegociacao();\r\n\r\n\t\tthis._negociacaoService.cadastrar(negociacao)\r\n\t\t\t.then(mensagem => {\r\n\t\t\t\tthis._listaNegociacoes.adiciona(negociacao);\r\n\t\t\t\tthis._mensagem.texto = mensagem;\r\n\t\t\t\tthis._limpaFormulario();\r\n\t\t\t})\r\n\t\t\t.catch(erro => this._mensagem.texto = erro);\r\n\t}\r\n\r\n\r\n\tapaga() {\r\n\r\n\t\tthis._negociacaoService\r\n\t\t\t.apagar()\r\n\t\t\t.then(mensagem => {\r\n\t\t\t\tthis._mensagem.texto = mensagem;\r\n\t\t\t\tthis._listaNegociacoes.esvazia();\r\n\t\t\t})\r\n\t\t\t.catch(erro => this._mensagem.texto = erro);\r\n\t}\r\n\r\n\t\r\n\timportaNegociacoes() {\r\n\r\n\t\tthis._negociacaoService\r\n\t\t\t.importa(this._listaNegociacoes.negociacoes)\r\n\t\t\t.then(negociacoes => { negociacoes.forEach(negociacao => \r\n\t\t\t\tthis._listaNegociacoes.adiciona(negociacao));\r\n\t\t\t\tthis._mensagem.texto = 'Negociações importadas com sucesso.';\r\n\t\t\t})\r\n\t\t\t.catch(erro => this._mensagem.texto = erro);\r\n\t}\r\n\r\n\t_criaNegociacao() {\r\n\t\treturn new Negociacao(\r\n\t\t\tDateHelper.textoParaData(this._inputData.value),\r\n\t\t\tparseInt(this._inputQuantidade.value),\r\n\t\t\tparseFloat(this._inputValor.value));\r\n\t}\r\n\r\n\t_limpaFormulario() {\r\n\t\tthis._inputData.value = '';\r\n\t\tthis._inputQuantidade.value = 1;\r\n\t\tthis._inputValor.value = 0.0;\r\n\r\n\t\tthis._inputData.focus();\r\n\t}\r\n\r\n\tordena(coluna) {\r\n\t\tif (this._ordemAtual == coluna) {\r\n\t\t\tthis._listaNegociacoes.inverteOrdem();\r\n\t\t} else {\r\n\t\t\tthis._listaNegociacoes.ordena((a, b) => a[coluna] - b[coluna]);\r\n\t\t}\r\n\t\tthis._ordemAtual = coluna;\r\n\t\t\r\n\t}\r\n\r\n}\r\n\r\nlet negociacaoController = new NegociacaoController();\r\n\r\nexport function currentInstance() {\r\n\treturn negociacaoController;\r\n}"]}